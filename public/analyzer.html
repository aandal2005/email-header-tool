<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Email Header Analyzer</title>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
  <style>
    body {
      font-family: Arial, sans-serif;
      background: linear-gradient(135deg,#2563eb,#22c55e);
      color: #333;
      margin: 0;
      padding: 0;
    }
    header {
      background: #1e293b;
      color: white;
      padding: 20px;
      text-align: center;
      font-size: 24px;
      font-weight: bold;
    }
    main {
      max-width: 900px;
      margin: 30px auto;
      background: white;
      padding: 30px;
      border-radius: 15px;
      box-shadow: 0 8px 20px rgba(0,0,0,0.2);
    }
    textarea {
      width: 100%;
      height: 150px;
      padding: 15px;
      border: 2px solid #ddd;
      border-radius: 10px;
      font-size: 14px;
      resize: vertical;
    }
    button {
      margin-top: 20px;
      padding: 12px 25px;
      background: #2563eb;
      color: white;
      font-size: 16px;
      border: none;
      border-radius: 8px;
      cursor: pointer;
      transition: 0.3s;
      margin-right: 10px;
    }
    button:hover { background: #1d4ed8; }
    table { border-collapse: collapse; width: 100%; margin-top: 20px; }
    table, th, td { border: 1px solid #ddd; }
    th, td { padding: 10px; text-align: left; }
    th { background-color: #2563eb; color: white; }
    .result-card { margin-top: 20px; }
  </style>
</head>
<body>
  <header>üìß Email Header Analyzer</header>
  <main>
    <h2>Paste your email header below</h2>
    <textarea id="emailHeader" placeholder="Paste your email header here..."></textarea><br>
    <button onclick="analyzeHeader()">üîç Analyze</button>

    <div id="result" class="result-card"></div>
  </main>

  <script>
    async function analyzeHeader() {
      const headerText = document.getElementById("emailHeader").value.trim();
      const resultDiv = document.getElementById("result");
      resultDiv.innerHTML = "<p>Analyzing...</p>";

      if (!headerText) {
        resultDiv.innerHTML = "<p style='color:red;'>Please paste an email header!</p>";
        return;
      }

      try {
        const backendURL = "https://email-header-backend.onrender.com/analyze"; // your backend
        const res = await fetch(backendURL, {
          method: "POST",
          headers: { "Content-Type": "application/json" },
          body: JSON.stringify({ header: headerText })
        });

        if (!res.ok) throw new Error(`HTTP error! status: ${res.status}`);
        const data = await res.json();

        if (data.error) {
          resultDiv.innerHTML = `<p style='color:red;'>Error: ${data.error}</p>`;
          return;
        }

        // Display result in a table
        resultDiv.innerHTML = `
          <table>
            <tr><th>Field</th><th>Value</th></tr>
            <tr><td>From</td><td>${data.From || "N/A"}</td></tr>
            <tr><td>To</td><td>${data.To || "N/A"}</td></tr>
            <tr><td>Subject</td><td>${data.Subject || "N/A"}</td></tr>
            <tr><td>Date</td><td>${data.Date || "N/A"}</td></tr>
            <tr><td>SPF</td><td>${data["SPF Status"] || "N/A"}</td></tr>
            <tr><td>DKIM</td><td>${data["DKIM Status"] || "N/A"}</td></tr>
            <tr><td>DMARC</td><td>${data["DMARC Status"] || "N/A"}</td></tr>
            <tr><td>Safe Meter</td><td>${data["Safe Meter"] || "N/A"}</td></tr>
            <tr><td>Sender IP</td><td>${data["Sender IP"] || "N/A"}</td></tr>
            <tr><td>IP Location</td><td>${data["IP Location"] || "N/A"}</td></tr>
          </table>
        `;
      } catch (err) {
        console.error(err);
        resultDiv.innerHTML = `<p style='color:red;'>Error fetching results: ${err.message}</p>`;
      }
    }
  </script>
</body>
</html>
